# Learning spatially varying regularization via TransMorph
<a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg"></a> [![arXiv](https://img.shields.io/badge/arXiv-2303.06168-b31b1b.svg)](https://arxiv.org/abs/2303.06168)

keywords: image registration, spatially-varying regularization

This is an official PyTorch implementation of the preprint: "Spatially-varying Regularization with Conditional Transformer for Unsupervised Image Registration" [arXiv](https://arxiv.org/abs/2303.06168).

**You may find the preprocessed IXI dataset here: [TransMorph on IXI](https://github.com/junyuchen245/TransMorph_Transformer_for_Medical_Image_Registration/blob/main/IXI/TransMorph_on_IXI.md)**

## Network architecture:
<img src="https://github.com/junyuchen245/Spatially_varying_regularization/blob/main/Figs/overall_framework.jpg" width="800"/>

## Learned regularization weights:
<img src="https://github.com/junyuchen245/Spatially_varying_regularization/blob/main/Figs/adaptive_weights.jpg" width="800"/>

## Citation:
If you find this code is useful in your research, please consider to cite:
    
    @article{chen2023spatially,
      title={Spatially-varying Regularization with Conditional Transformer for Unsupervised Image Registration},
      author={Chen, Junyu and Liu, Yihao and He, Yufan and Du, Yong},
      journal={arXiv preprint arXiv:2303.06168},
      year={2023}
    }

### Also see how we evaluate deformation regularity: [Digital Diffeomorphism](https://github.com/yihao6/digital_diffeomorphism)

### <a href="https://junyuchen245.github.io"> About Me</a>
